package org.ndc.xmlsign;

import java.io.File;
import java.io.IOException;
import java.io.InputStream;
import java.lang.reflect.Field;
import java.net.URL;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.StandardCopyOption;
import java.util.Enumeration;
import java.util.Map;
import java.util.Scanner;
import java.util.jar.JarEntry;
import java.util.jar.JarFile;

class Main {

    public static void main(String[] args) throws Exception {
        Signxmlsec signxmlsec = new Signxmlsec();

    // Prepare input data
        PrepareDataToSignInput input = new PrepareDataToSignInput();
        input.fileXml = "PD94bWwgdmVyc2lvbj0iMS4wIj8+DQo8SERvbj4NCgk8RExIRG9uIElkPSJTaWduRGF0YSI+DQoJCTxUVENodW5nPg0KCQkJPEhERENLUFRRdWFuPjA8L0hERENLUFRRdWFuPg0KCQkJPFBCYW4+Mi4xLjA8L1BCYW4+DQoJCQk8VEhEb24+SCYjeEQzO0EgJiN4MTEwOyYjeDFBMDtOIEImI3hDMTtOIEgmI3hDMDtORzwvVEhEb24+DQoJCQk8S0hNU0hEb24+MjwvS0hNU0hEb24+DQoJCQk8S0hIRG9uPkMyNVREVDwvS0hIRG9uPg0KCQkJPFNIRG9uPjE8L1NIRG9uPg0KCQkJPE1IU28vPg0KCQkJPE5MYXA+MjAyNS0wNy0wMTwvTkxhcD4NCgkJCTxTQktlLz4NCgkJCTxOQktlLz4NCgkJCTxEVlRUZT5WTkQ8L0RWVFRlPg0KCQkJPFRHaWE+MTwvVEdpYT4NCgkJCTxIRENUVENoaW5oPjA8L0hEQ1RUQ2hpbmg+DQoJCQk8SFRUVG9hbj5UaSYjeDFFQzE7biBtJiN4MUVCNzt0PC9IVFRUb2FuPg0KCQkJPE1TVFRDR1A+MDQwMTQ4NjkwMTwvTVNUVENHUD4NCgkJCTxNU1REVk5VTkxIRG9uLz4NCgkJCTxURFZOVU5MSERvbi8+DQoJCQk8RENEVk5VTkxIRG9uLz4NCgkJCTxUVEtoYWM+DQoJCQkJPFRUaW4+DQoJCQkJCTxUVHJ1b25nPkhvYURvbl9Mb2FpPC9UVHJ1b25nPg0KCQkJCQk8S0RMaWV1PnN0cmluZzwvS0RMaWV1Pg0KCQkJCQk8RExpZXU+MTwvRExpZXU+DQoJCQkJPC9UVGluPg0KCQkJCTxUVGluPg0KCQkJCQk8VFRydW9uZz5RdWFuTHlfU29CYW9NYXQ8L1RUcnVvbmc+DQoJCQkJCTxLRExpZXU+c3RyaW5nPC9LRExpZXU+DQoJCQkJCTxETGlldT4xTTcwQzJTTTNWVkE8L0RMaWV1Pg0KCQkJCTwvVFRpbj4NCgkJCTwvVFRLaGFjPg0KCQk8L1RUQ2h1bmc+DQoJCTxOREhEb24+DQoJCQk8TkJhbj4NCgkJCQk8VGVuPlZJU05BTSAtIEtJJiN4MUVDMjtNIFRIJiN4MUVFQzsgSCYjeDExMDsmI3gxMTA7VCBDJiN4RDM7IE0mI3hDMzs8L1Rlbj4NCgkJCQk8TVNUPjA0MDE0ODY5MDEtOTk5PC9NU1Q+DQoJCQkJPERDaGk+UyYjeDFFRDE7IDMzICYjeDExMTsmI3gxQjA7JiN4MUVERDtuZyBIJiN4MUVBMztpIEgmI3gxRUQzOywgUGgmI3gxQjA7JiN4MUVERDtuZyBUaGFuaCBCJiN4RUM7bmgsIFF1JiN4MUVBRDtuIEgmI3gxRUEzO2kgQ2gmI3hFMjt1LCBUaCYjeEUwO25oIHBoJiN4MUVEMTsgJiN4MTEwOyYjeEUwOyBOJiN4MUVCNTtuZywgVmkmI3gxRUM3O3QgTmFtPC9EQ2hpPg0KCQkJCTxTRFRob2FpPjA5MzY0ODY3NzQ8L1NEVGhvYWk+DQoJCQkJPERDVERUdT5oYWgwOTExMDlAZ21haWwuY29tPC9EQ1REVHU+DQoJCQkJPFNUS05IYW5nPjEyMzM0MTIzMTIzPC9TVEtOSGFuZz4NCgkJCQk8VE5IYW5nLz4NCgkJCQk8RmF4PjAyNDk4OTk5OTk8L0ZheD4NCgkJCQk8V2Vic2l0ZS8+DQoJCQkJPFRUS2hhYz4NCgkJCQkJPFRUaW4+DQoJCQkJCQk8VFRydW9uZz5ETkJhbl9OZ3VvaURhaURpZW48L1RUcnVvbmc+DQoJCQkJCQk8S0RMaWV1PnN0cmluZzwvS0RMaWV1Pg0KCQkJCQkJPERMaWV1Pk5ndXkmI3gxRUM1O24gViYjeDEwMztuIEgmI3hGOTtuZyBWaXNuYW08L0RMaWV1Pg0KCQkJCQk8L1RUaW4+DQoJCQkJCTxUVGluPg0KCQkJCQkJPFRUcnVvbmc+TWF1X05ndW9pTGFwPC9UVHJ1b25nPg0KCQkJCQkJPEtETGlldT5zdHJpbmc8L0tETGlldT4NCgkJCQkJCTxETGlldT4wNDAxNDg2OTAxOTk5QE1TUDwvRExpZXU+DQoJCQkJCTwvVFRpbj4NCgkJCQk8L1RUS2hhYz4NCgkJCTwvTkJhbj4NCgkJCTxOTXVhPg0KCQkJCTxNRFZRSE5TYWNoLz4NCgkJCQk8VGVuLz4NCgkJCQk8RENoaS8+DQoJCQkJPE1LSGFuZy8+DQoJCQkJPFNEVGhvYWkvPg0KCQkJCTxEQ1REVHU+MUBnbWFpbC5jb208L0RDVERUdT4NCgkJCQk8SFZUTk1IYW5nPjE8L0hWVE5NSGFuZz4NCgkJCQk8U1RLTkhhbmcvPg0KCQkJCTxUTkhhbmcvPg0KCQkJCTxDQ0NEYW4vPg0KCQkJPC9OTXVhPg0KCQkJPERTSEhEVnU+DQoJCQkJPEhIRFZ1Pg0KCQkJCQk8VENoYXQ+MTwvVENoYXQ+DQoJCQkJCTxTVFQ+MTwvU1RUPg0KCQkJCQk8VEhIRFZ1PjE8L1RISERWdT4NCgkJCQkJPFRoVGllbj4wPC9UaFRpZW4+DQoJCQkJCTxUVEtoYWM+DQoJCQkJCQk8VFRpbj4NCgkJCQkJCQk8VFRydW9uZz5Ub25nVGllbl9UaHVlPC9UVHJ1b25nPg0KCQkJCQkJCTxLRExpZXU+c3RyaW5nPC9LRExpZXU+DQoJCQkJCQkJPERMaWV1PjAuMDAwMDAwPC9ETGlldT4NCgkJCQkJCTwvVFRpbj4NCgkJCQkJPC9UVEtoYWM+DQoJCQkJPC9ISERWdT4NCgkJCTwvRFNISERWdT4NCgkJCTxUVG9hbj4NCgkJCQk8RFNMUGhpPg0KCQkJCQk8TFBoaT4NCgkJCQkJCTxUTFBoaS8+DQoJCQkJCQk8VFBoaS8+DQoJCQkJCTwvTFBoaT4NCgkJCQk8L0RTTFBoaT4NCgkJCQk8VFRDS1RNYWk+MC4wMDAwMDA8L1RUQ0tUTWFpPg0KCQkJCTxUR1RLaGFjLz4NCgkJCQk8VGdUVFRCU28+MC4wMDAwMDA8L1RnVFRUQlNvPg0KCQkJCTxUZ1RUVEJDaHU+S2gmI3hGNDtuZyAmI3gxMTE7JiN4MUVEMztuZzwvVGdUVFRCQ2h1Pg0KCQkJPC9UVG9hbj4NCgkJPC9OREhEb24+DQoJCTxUVEtoYWM+DQoJCQk8VFRpbj4NCgkJCQk8VFRydW9uZz5RdWFuTHlfQ2h1eWVuRG9pPC9UVHJ1b25nPg0KCQkJCTxLRExpZXU+c3RyaW5nPC9LRExpZXU+DQoJCQkJPERMaWV1PkZhbHNlPC9ETGlldT4NCgkJCTwvVFRpbj4NCgkJCTxUVGluPg0KCQkJCTxUVHJ1b25nPkROQmFuX05nYXlLeTwvVFRydW9uZz4NCgkJCQk8S0RMaWV1PnN0cmluZzwvS0RMaWV1Pg0KCQkJCTxETGlldT4yMDI1LTA3LTAxIDEzOjQ2OjAxPC9ETGlldT4NCgkJCTwvVFRpbj4NCgkJCTxUVGluPg0KCQkJCTxUVHJ1b25nPklkSG9hRG9uPC9UVHJ1b25nPg0KCQkJCTxLRExpZXU+c3RyaW5nPC9LRExpZXU+DQoJCQkJPERMaWV1PjM0NjY5MzE8L0RMaWV1Pg0KCQkJPC9UVGluPg0KCQkJPFRUaW4+DQoJCQkJPFRUcnVvbmc+RmluYWxQYWdlPC9UVHJ1b25nPg0KCQkJCTxLRExpZXU+c3RyaW5nPC9LRExpZXU+DQoJCQkJPERMaWV1PjE8L0RMaWV1Pg0KCQkJPC9UVGluPg0KCQkJPFRUaW4+DQoJCQkJPFRUcnVvbmc+SXNTaG93QXJlYTwvVFRydW9uZz4NCgkJCQk8S0RMaWV1PnN0cmluZzwvS0RMaWV1Pg0KCQkJCTxETGlldT4wPC9ETGlldT4NCgkJCTwvVFRpbj4NCgkJCTxUVGluPg0KCQkJCTxUVHJ1b25nPkVtcHR5TGluZU51bWJlcjwvVFRydW9uZz4NCgkJCQk8S0RMaWV1PnN0cmluZzwvS0RMaWV1Pg0KCQkJCTxETGlldT45PC9ETGlldT4NCgkJCTwvVFRpbj4NCgkJPC9UVEtoYWM+DQoJPC9ETEhEb24+DQoJPERMUVJDb2RlPjAwMDIwMTAxMDIxMjI2NTMwMDMyNDY4RjYzQTU4M0I2NEVENkFBOTRDMDBEMTcxNzRDNTYwMTEzMDQwMTQ4NjkwMTk5OTUyMDQwMDAwNTMwMzcwNDU0MDEwNTgwMlZOOTk4NTAwMzI0NjhGNjNBNTgzQjY0RUQ2QUE5NEMwMEQxNzE3NEM1NjAxMTMwNDAxNDg2OTAxOTk5MDIwMTIwMzA2QzI1VERUMDQwMTEwNTA4MjAyNTA3MDE2MzA0MUEyQjwvRExRUkNvZGU+DQoJPE1DQ1FUIElkPSJJZC01ZjA5ZTZhZWVmYmY0MjM0OTMxNTQ1OTllN2YxNGFiZSI+MDBFQTYwRDVDQUIyMUI0RUMwQTk4OTg0MDAyNTBEMjFGNTwvTUNDUVQ+DQoJPERTQ0tTPg0KCQk8TkJhbi8+DQoJCTxOTXVhLz4NCgkJPENRVC8+DQoJCTxDQ0tTS2hhYy8+DQoJPC9EU0NLUz4NCjwvSERvbj4NCg=="; // truncated for brevity
        input.fileCertPem = "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURqekNDQW5lZ0F3SUJBZ0lVU0Urb3FsbXJMdUJlWnhuejVGQy9xYVBvYmE0d0RRWUpLb1pJaHZjTkFRRUwKQlFBd0ZERVNNQkFHQTFVRUF3d0pUMDVGUTBFdFUxVkNNQjRYRFRJMU1ERXhPREE0TVRZd01Gb1hEVEkyTURNeApNekF6TVRZd01Gb3dVVEVoTUI4R0NnbVNKb21UOGl4a0FRRU1FVU5EUTBRNk5UVTFOVFV3TURFd01UY3lNUkl3CkVBWURWUVFEREFsSWIyRnVaeUJXWVc0eEN6QUpCZ05WQkFnTUFraFFNUXN3Q1FZRFZRUUdFd0pXVGpDQ0FTSXcKRFFZSktvWklodmNOQVFFQkJRQURnZ0VQQURDQ0FRb0NnZ0VCQUx0YUVJU01lOXhCY2tZM3VtL3FTbXI0dEpZbgpiUVo1TEtxK1Zqd2wvZExzcUJoeFVDQjlYbWp6RktqNDBLM2xmSERFODVsRTMxdzYyMUFSVVZVQW95Z05tYURuClpuSEVVOG1tRTllSTZDcVZyOFhidjgxeDhYTmFyZGVIalZubERTcEJteVRzYmFrQXZnSGRCdXpxMjBKNXJCYnUKTGdMVjVnYldvTzVML0FiVEdqeWo1QTV2MUVPeXpUbnZxdWVQTGM3VTY3WWU0VFd2S0Z3UXB0Tzc1YTdEVm9hNApMWWRBVTFnZGVNWTQ4Y0hpZ3JjeFJxa3dpblIyRWNab2hEaDM3bmhsbGw2OE5RTjdER05wTTBiZ1FUS0EvdTV0CkhqYmJkRndKZkZ3MFBFRXc4WDhBZXVXTGUwTVZTTDUxYVU1aVpJc25jYy9qR3JYdWhwYVJENFg1eFNVQ0F3RUEKQWFPQm16Q0JtREFNQmdOVkhSTUJBZjhFQWpBQU1COEdBMVVkSXdRWU1CYUFGQ3NHT0xrZ01qS2ZxNmtnNEk1dgp6aGRac1NqeU1Ca0dBMVVkRVFRU01CQ0JEblJsYzNSQVoyMWhhV3d1WTI5dE1CMEdBMVVkSlFRV01CUUdDQ3NHCkFRVUZCd01DQmdnckJnRUZCUWNEQkRBZEJnTlZIUTRFRmdRVTRUek1iY2pjZ3RkZjA0YXU0L01QaFhPWEljRXcKRGdZRFZSMFBBUUgvQkFRREFnWGdNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUJzV1ZFZHYvTVZ6RzBwQTlJUAozOGZWVVJ6Q3QyQVZKWWZzcExOc1VVbElTMGYvcUg2T1lncVhSS0tqRm1MTm02QVJGbzJjVVFKQWZKOU1kQUNqClVmaGJHNmwybGZvbmRhWi95VVMxZmoyQWFMSXk4Q20xSlNnWEJWTlE0VmREZ3VzRS91RTkxWlhWVGRlbzBNRkMKSDI5OEM4aFY1R0VxRjhiWXJwWUJXQk9Vam5FZExZb01JZFQ2cjZweTNQa0VnYkgxOTZjNXgwbWtBZXJqeGJsNgpJaGVKd1pYY1pmQk5KRG1MVW9wSnBabTdtMUdyclhHRGNBck9XYUN5elo2dDJrWlRsRkgzUmlPRDQ3OVJEclpzCmw1eWdBN2ljN2VmcHFZU0tWRFZsRTB4RTlTejNwczAyd1lTU3pUaGN6MDI5ZUQxTUoxd1BCTEg0NnlPd2VqSUgKdjlMagotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0t"; // truncated
        input.nodePath = "HDon/DSCKS/NBan";

// Call prepare method
        PrepareDataToSignOutput res = signxmlsec.prepareDataToSign(input);

// Read base64 signature from console
        Scanner scanner = new Scanner(System.in);
        String ba64 = scanner.nextLine();

// Finalize signature
        FinalizeSignatureInput finalizeInput = new FinalizeSignatureInput();
        finalizeInput.key = res.key;
        finalizeInput.base64Signature = ba64;

        FinalizeSignatureOutput file = signxmlsec.finalizeSignature(finalizeInput);
    }
}
